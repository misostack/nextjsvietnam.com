<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="home" href="http://localhost:1313/" />
    <meta name="generator" content="jsguru cms" />

    
    
      
    

    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    
    
      
              
        
        <link rel="stylesheet" href="http://localhost:1313/themes/2022/dist/main.css" />
             
    
      
              
        
        <link rel="stylesheet" href="http://localhost:1313/themes/2022/dist/home.css" />
             
    
      
              
        
        <link rel="stylesheet" href="http://localhost:1313/themes/2022/dist/page.css" />
             
        
    
    
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RWE4MLJYE6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-RWE4MLJYE6');    
    </script>    
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1642510310947288"
    crossorigin="anonymous"></script>    
    
    
    
<title>Nestjs Passing Data Between Layers in Domain Driven Design | In Domain Driven Design, passing data between layers is one of the most important parts of your design, the dto/models will be use should belongs to which layer? | Useful NodeJS Tricks, JavaScript Tips, Tricks and Best Practices</title>
<meta name="robots" content="all" />
<meta name="keywords" content="nestjs, dto, validation" />
<meta name="description" content="In Domain Driven Design, passing data between layers is one of the most important parts of your design, the dto/models will be use should belongs to which layer?" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://user-images.githubusercontent.com/31009750/181449337-70081a76-5a01-4229-805e-39ed0ded6b5b.png" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="750" />
<meta property="og:image:height" content="300" />
<meta
  property="article:publisher"
  content="https://www.facebook.com/nextjsvietnam"
/>

<meta property="article:published_time" content="2024-04-27T14:31:26+07:00" />
<meta property="article:modified_time" content="2024-04-27T14:31:26+07:00" />

    
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png" />
<link
  rel="icon"
  type="image/png"
  sizes="192x192"
  href="/android-icon-192x192.png"
/>
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
<link rel="manifest" href="/manifest.json" />
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png" />
<meta name="theme-color" content="#ffffff" />

  </head>
  <body class="body-nav-fixed">
    <nav class="nav-fixed nav-default z-50">
    <div class="container">
      <div class="nav-container flex flex-wrap justify-between items-center">
        <a href="http://localhost:1313/" class="nav-brand inline-block">
          
          <img class="h-12" src="http://localhost:1313/themes/2022/src/assets/images/logo.png" 
          alt="Stunning" />
        </a>
        <a href="javascript:void(0);" data-menu="#menu-main_menu" class="nav-menu-toggle"><span
          class="material-icons">menu</span></a>
        <ul id="menu-main_menu" class="nav-menu h-0 md:h-auto">
          <form class="nav-menu-search-bar md:hidden relative">
            <button class="nav-menu-search-bar-search-btn absolute h-full">
              <svg class="w-3 h-3 text-gray-600" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24">
                <path
                  d="M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z">
                </path>
              </svg>
            </button>
            <input name="s" type="text" class="w-full" />
          </form>
          
          
            <li class="nav-menu-item">
            <a class="nav-menu-link" href="http://localhost:1313/categories/systemdesign">System Design
                
                    <span class="material-icons">keyboard_arrow_down</span>
                
            </a>
            
                <ul class="sub-menu">                                    
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/software-architecture">Software Architecture</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/microservice-architecture">Microservice Architecture</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/aws">Learn AWS The Right Way</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/aws-labs">AWS Hands-On Labs</a></li>
                
                </ul>
            
            </li>
          
            <li class="nav-menu-item">
            <a class="nav-menu-link" href="http://localhost:1313/categories/cheatsheet">Cheatsheet
                
                    <span class="material-icons">keyboard_arrow_down</span>
                
            </a>
            
                <ul class="sub-menu">                                    
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/nestjs-examples">NestJS Examples</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/reactjs-examples">ReactJS Examples</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/react-native-examples">React Native Examples</a></li>
                
                </ul>
            
            </li>
          
            <li class="nav-menu-item">
            <a class="nav-menu-link" href="http://localhost:1313/categories/frameworks">Frameworks
                
                    <span class="material-icons">keyboard_arrow_down</span>
                
            </a>
            
                <ul class="sub-menu">                                    
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/nestjs">NestJS</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/reactjs">ReactJS</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/nextjs">NextJS</a></li>
                
                </ul>
            
            </li>
          
            <li class="nav-menu-item">
            <a class="nav-menu-link" href="http://localhost:1313/">Tutorials
                
                    <span class="material-icons">keyboard_arrow_down</span>
                
            </a>
            
                <ul class="sub-menu">                                    
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/nestjs-tutorial">NestJS Tutorial</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/reactjs-tutorial">ReactJS Tutorial</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/nextjs-tutorial">NextJS Tutorial</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://localhost:1313/categories/java">Java Tutorial</a></li>
                
                </ul>
            
            </li>
          
            <li class="nav-menu-item">
            <a class="nav-menu-link" href="http://localhost:1313/">Tools
                
                    <span class="material-icons">keyboard_arrow_down</span>
                
            </a>
            
                <ul class="sub-menu">                                    
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="https://regex101.com/">Online Regex</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="http://www.bashoneliners.com/">Bash Online</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="https://www.epochconverter.com/">Unix Timestamp Conversion</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="https://ryanstutorials.net/bash-scripting-tutorial/">Bash Scripting</a></li>
                
                    <li class="nav-menu-item"><a class="nav-menu-link" href="https://explainshell.com/">Explain Shell</a></li>
                
                </ul>
            
            </li>
          
          <form class="nav-menu-search-bar hidden md:flex relative">
            <button class="nav-menu-search-bar-search-btn absolute h-full">
              <svg class="w-3 h-3 text-gray-600" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24">
                <path
                  d="M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z">
                </path>
              </svg>
            </button>
            <input name="s" type="text" class="w-full" />
          </form>
        </ul>
      </div>
    </div>
</nav>

    <main>
    
  <section class="container section">
    <div class="page-content max-w-2xl mx-auto">
        <img src="https://user-images.githubusercontent.com/31009750/181449337-70081a76-5a01-4229-805e-39ed0ded6b5b.png" class="img-responsive" alt="Nestjs Passing Data Between Layers in Domain Driven Design" />
        <h1>Nestjs Passing Data Between Layers in Domain Driven Design</h1>
        
          
          
          <p><strong>Post Date</strong> : 2024-04-27T14:31:26+07:00</p>
          <p><strong>Modified Date</strong> : 2024-04-27T14:31:26+07:00</p>
        <p>
            <strong>Category:</strong>
            
            <a class="m-1 p-1 text-xs font-bold leading-none border border-gray-200 bg-white" href="http://localhost:1313/categories/nestjs">nestjs</a>
            
            <a class="m-1 p-1 text-xs font-bold leading-none border border-gray-200 bg-white" href="http://localhost:1313/categories/frameworks">frameworks</a>
            
        </p>
        <p>
          <strong>Tags:</strong>
          
             <a class="m-1 p-1 text-xs font-bold leading-none border border-gray-200 bg-white"
             href="/tags/nestjs">nestjs</a>
          
        </p>                
        <p>We determined that we will have 3 layers: Presentation(Controller), Service, Data Layer(Repository). And the flow is:</p>
<ul>
<li>Controllers will inject Services to use</li>
<li>Services will inject Repository to use.</li>
</ul>
<p>So when passing data between layers, the dto/models will be use should belongs to which layers.</p>
<h2 id="top-down-approach-1st-option">Top-Down Approach (1st Option)</h2>
<p><img src="https://gist.github.com/assets/31009750/716805a9-8ba0-4479-8f59-3039e560fbb3" alt="image"></p>
<h3 id="controllers-layer">Controllers Layer:</h3>
<ul>
<li>Responsibility: Handle incoming HTTP requests, delegate business logic to services.</li>
<li>Data Transfer: Interact with DTOs provided by services for transferring data between the client and the server.</li>
<li>Dependency: Depend on services for handling business logic. Remain unaware of entities.</li>
</ul>
<h3 id="services-layer">Services Layer:</h3>
<ul>
<li>Responsibility: Contain business logic, orchestrate data flow, and interact with repositories.</li>
<li>Data Transfer: Map DTOs to entities before passing them to the repository layer, and vice versa. Provide DTOs to controllers for data exchange.</li>
<li>Dependency: Depend on repositories for data access and storage operations.</li>
</ul>
<h3 id="repositories-layer">Repositories Layer:</h3>
<ul>
<li>Responsibility: Handle data access and storage operations, interact directly with the database, and manage entities.</li>
<li>Data Transfer: Operate directly with entities without any knowledge of DTOs or higher-level business logic.</li>
<li>Dependency: Independent of higher-level layers, operates directly with the database.</li>
</ul>
<h3 id="user-module-sample">User Module Sample</h3>
<blockquote>
<p>User Controller</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Controller</span>, <span style="color:#a6e22e">Get</span>, <span style="color:#a6e22e">Post</span>, <span style="color:#a6e22e">Body</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/common&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserService</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./user.service&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">CreateUserDTO</span>, <span style="color:#a6e22e">UserDTO</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./dto/user.dto&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Controller</span>(<span style="color:#e6db74">&#34;users&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserController</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> <span style="color:#a6e22e">userService</span>: <span style="color:#66d9ef">UserService</span>) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Get</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">getUsers</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserDTO</span><span style="color:#960050;background-color:#1e0010">[]</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userService</span>.<span style="color:#a6e22e">getUsers</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Post</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">createUser</span>(<span style="color:#66d9ef">@Body</span>() <span style="color:#a6e22e">createUserDTO</span>: <span style="color:#66d9ef">CreateUserDTO</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserDTO</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userService</span>.<span style="color:#a6e22e">createUser</span>(<span style="color:#a6e22e">createUserDTO</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>User Service</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Injectable</span>, <span style="color:#a6e22e">BadRequestException</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/common&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserRepository</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./user.repository&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserEntity</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./user.entity&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">CreateUserDTO</span>, <span style="color:#a6e22e">UserDTO</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./dto/user.dto&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">validate</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;class-validator&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Injectable</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserService</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> <span style="color:#a6e22e">userRepository</span>: <span style="color:#66d9ef">UserRepository</span>) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">getUsers</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserDTO</span><span style="color:#960050;background-color:#1e0010">[]</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">users</span>: <span style="color:#66d9ef">UserEntity</span>[] <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">findAll</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">users</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">user</span>) <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mapEntityToDTO</span>(<span style="color:#a6e22e">user</span>));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">createUser</span>(<span style="color:#a6e22e">createUserDTO</span>: <span style="color:#66d9ef">CreateUserDTO</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserDTO</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Perform data validation using class-validator
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">errors</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">validate</span>(<span style="color:#a6e22e">createUserDTO</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">BadRequestException</span>(<span style="color:#a6e22e">errors</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Additional business logic for creating a user
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">userEntity</span>: <span style="color:#66d9ef">UserEntity</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mapDTOToEntity</span>(<span style="color:#a6e22e">createUserDTO</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">createdUser</span>: <span style="color:#66d9ef">UserEntity</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">create</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">userEntity</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mapEntityToDTO</span>(<span style="color:#a6e22e">createdUser</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Additional methods and business logic can be added here
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">mapDTOToEntity</span>(<span style="color:#a6e22e">dto</span>: <span style="color:#66d9ef">CreateUserDTO</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">UserEntity</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Map DTO to entity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">mapEntityToDTO</span>(<span style="color:#a6e22e">entity</span>: <span style="color:#66d9ef">UserEntity</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">UserDTO</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Map entity to DTO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>User Repository</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Injectable</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/common&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserEntity</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./user.entity&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Injectable</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserRepository</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">findAll</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserEntity</span><span style="color:#960050;background-color:#1e0010">[]</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Retrieve users from the database
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">user</span>: <span style="color:#66d9ef">UserEntity</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserEntity</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Save user to the database
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="pros">Pros:</h3>
<ol>
<li><strong>Clear Separation of Concerns</strong>: The top-down approach enforces a clear separation of concerns, with controllers handling HTTP request/response logic, services containing business logic, and repositories managing data access/storage operations.</li>
<li><strong>Modularity</strong>: Each layer has a specific responsibility, making it easier to understand and maintain the codebase. Changes in one layer typically have minimal impact on others.</li>
<li><strong>Scalability</strong>: The layered architecture facilitates scalability, as new features or changes can be implemented within specific layers without affecting the overall structure.</li>
<li><strong>Testability</strong>: The separation of concerns makes it easier to write unit tests for each layer independently, improving overall test coverage and code quality.</li>
<li><strong>Flexibility</strong>: By defining clear interfaces between layers, developers can easily swap out implementations or refactor code within a layer without affecting other parts of the application.</li>
</ol>
<h3 id="cons">Cons:</h3>
<ol>
<li><strong>Increased Complexity</strong>: Managing the interactions between layers, especially in larger applications with complex business logic, can introduce complexity and make the code harder to maintain.</li>
<li><strong>Performance Overhead</strong>: Passing data between layers, especially when using DTOs or performing excessive data transformation, can incur performance overhead, impacting application performance.</li>
<li><strong>Potential for Duplication</strong>: In some cases, similar logic may be duplicated across layers, leading to code duplication and maintenance overhead.</li>
<li><strong>Dependency Management</strong>: Managing dependencies between layers, especially when dealing with circular dependencies or complex data flows, can be challenging and require careful design.</li>
<li><strong>Over-Abstraction</strong>: Overly strict layering or excessive abstraction can lead to over-engineering and make the codebase harder to understand for new developers.</li>
</ol>
<p>Overall, while the top-down approach provides clear benefits in terms of separation of concerns, modularity, and testability, it also comes with challenges related to complexity, performance, and dependency management. It&rsquo;s essential to strike a balance and carefully design the interactions between layers to ensure a maintainable and scalable architecture.</p>
<h2 id="bottom-up-approach-2nd-option">Bottom-Up Approach (2nd Option)</h2>
<p><img src="https://gist.github.com/assets/31009750/9facbc53-23cb-4bcb-952a-9852b657a502" alt="image"></p>
<h3 id="bottom-up-approach-concepts">Bottom-Up Approach Concepts:</h3>
<p><strong>Repositories Layer:</strong></p>
<ul>
<li><strong>Foundation Layer</strong>: The repository layer forms the foundation of the application. It is responsible for handling data access and storage operations, directly interacting with the database and managing entities.</li>
<li><strong>Interaction with Database</strong>: Repositories interact directly with the database, executing queries and managing transactions to retrieve, create, update, and delete data.</li>
<li><strong>Awareness of DTOs</strong>: Repositories may be aware of DTOs, utilizing them for data manipulation and storage operations.</li>
</ul>
<p><strong>Services Layer:</strong></p>
<ul>
<li><strong>Built upon Repositories</strong>: The service layer is built upon the foundation provided by the repository layer. It contains business logic and orchestrates data flow within the application.</li>
<li><strong>Mapping DTOs to Entities</strong>: Services may handle DTO-to-entity mapping, but they are not required to do so if repositories are aware of DTOs.</li>
<li><strong>Business Logic</strong>: Services encapsulate business logic, performing operations such as validation, transformation, and coordination of data between different parts of the application.</li>
</ul>
<p><strong>Controllers Layer:</strong></p>
<ul>
<li><strong>Dependency on Services</strong>: Controllers depend on the service layer for handling HTTP requests and delegating business logic.</li>
<li><strong>HTTP Request Handling</strong>: Controllers handle incoming HTTP requests, utilizing DTOs defined at the controller layer to transfer data between the client and the server.</li>
<li><strong>Delegation to Services</strong>: Controllers delegate the execution of business logic to services, maintaining a separation of concerns and promoting modularity.</li>
</ul>
<h3 id="user-module-sample-1">User Module Sample</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#75715e">// UserEntity.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserEntity</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">name</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">email</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>(<span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>, <span style="color:#a6e22e">name</span>: <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">email</span>: <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">id</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">name</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">email</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">email</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// UserDTO.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserDTO</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">name</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">email</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// UserRepository.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Injectable</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/common&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserEntity</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./UserEntity&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserDTO</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./UserDTO&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Injectable</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserRepository</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">createUser</span>(<span style="color:#a6e22e">userData</span>: <span style="color:#66d9ef">UserDTO</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserEntity</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Save user data to the database and return the created user entity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">createdUser</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">UserEntity</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">userData</span>.<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">userData</span>.<span style="color:#a6e22e">email</span>); <span style="color:#75715e">// Simulated creation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">createdUser</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// UserService.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Injectable</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/common&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserRepository</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./UserRepository&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserEntity</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./UserEntity&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserDTO</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./UserDTO&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Injectable</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserService</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> <span style="color:#a6e22e">userRepository</span>: <span style="color:#66d9ef">UserRepository</span>) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">createUser</span>(<span style="color:#a6e22e">userData</span>: <span style="color:#66d9ef">UserDTO</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserEntity</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Additional business logic
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">createUser</span>(<span style="color:#a6e22e">userData</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// UserController.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Controller</span>, <span style="color:#a6e22e">Post</span>, <span style="color:#a6e22e">Body</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/common&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserService</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./UserService&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserDTO</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./UserDTO&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserEntity</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./UserEntity&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Controller</span>(<span style="color:#e6db74">&#34;users&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserController</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> <span style="color:#a6e22e">userService</span>: <span style="color:#66d9ef">UserService</span>) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Post</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">createUser</span>(<span style="color:#66d9ef">@Body</span>() <span style="color:#a6e22e">userData</span>: <span style="color:#66d9ef">UserDTO</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">UserEntity</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userService</span>.<span style="color:#a6e22e">createUser</span>(<span style="color:#a6e22e">userData</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="pros-1">Pros:</h3>
<ol>
<li>
<p><strong>Reduced Duplication</strong>: By allowing lower-level components (e.g., repositories) to be more aware and responsible, duplication of code and logic can be reduced. This can lead to cleaner and more maintainable code.</p>
</li>
<li>
<p><strong>Simplified Interactions</strong>: With lower-level components handling more responsibility, interactions between layers may become simpler and more streamlined. This can improve overall code readability and understandability.</p>
</li>
<li>
<p><strong>Flexibility in Mapping</strong>: Since repositories may be aware of DTOs, there is flexibility in how data is mapped between layers. This can provide more options for handling data transformation and manipulation.</p>
</li>
</ol>
<h3 id="cons-1">Cons:</h3>
<ol>
<li>
<p><strong>Tighter Coupling</strong>: Allowing lower-level components to be more aware of higher-level concepts (e.g., DTOs) can lead to tighter coupling between layers. Changes in one layer may have a greater impact on other layers, potentially reducing modularity.</p>
</li>
<li>
<p><strong>Potential Complexity</strong>: With more responsibility distributed to lower-level components, the overall complexity of the system may increase. Managing interactions and dependencies between layers may become more challenging, especially in larger applications.</p>
</li>
<li>
<p><strong>Risk of Over-Engineering</strong>: Allowing repositories to be aware of DTOs and handle more responsibility may lead to over-engineering if not carefully managed. Developers may be tempted to introduce unnecessary complexity or functionality into lower-level components, leading to bloated code.</p>
</li>
<li>
<p><strong>Limited Flexibility in Mapping</strong>: While repositories may be aware of DTOs, this approach may limit flexibility in how data is mapped between layers. If DTOs change frequently or need to be transformed differently in different contexts, repositories may become less adaptable.</p>
</li>
</ol>
<h2 id="hybrid-approach">Hybrid Approach</h2>
<p><img src="https://gist.github.com/assets/31009750/e2117950-46b8-4f37-bc32-b056b4b2118e" alt="image"></p>
<h3 id="controllers-layer-1">Controllers Layer</h3>
<h4 id="responsibilities">Responsibilities:</h4>
<ul>
<li>Handle incoming HTTP requests and respond to the client.</li>
<li>Utilize DTOs (Data Transfer Objects) to validate and structure incoming data from the client.</li>
</ul>
<h4 id="key-features">Key Features:</h4>
<ul>
<li><strong>Decorators and Routing</strong>: Use decorators to define routes, extract request data, and apply middleware, keeping the controllers clean and focused on their routing responsibilities.</li>
<li><strong>Error Handling</strong>: Implement exception filters to catch and handle errors from the business logic, ensuring responses are user-friendly.</li>
</ul>
<h3 id="services-layer-1">Services Layer</h3>
<h4 id="responsibilities-1">Responsibilities:</h4>
<ul>
<li>Contain and manage the core business logic of the application.</li>
<li>Orchestrate data flow between the presentation and data layers, ensuring that business rules are adhered to and data integrity is maintained.</li>
</ul>
<h4 id="key-features-1">Key Features:</h4>
<ul>
<li><strong>Framework Agnosticism</strong>: Services should be designed to be as independent of the web framework as possible, which enhances testability and reusability.</li>
<li><strong>Dependency Injection</strong>: Utilize NestJS&rsquo;s powerful dependency injection container to manage service dependencies, promoting loose coupling and modular architecture.</li>
</ul>
<h3 id="repositories-layer-1">Repositories Layer</h3>
<h4 id="responsibilities-2">Responsibilities:</h4>
<ul>
<li>Handle data persistence and retrieval operations directly with the database.</li>
<li>Execute queries, manage transactions, and perform data transformations.</li>
</ul>
<h4 id="key-features-2">Key Features:</h4>
<ul>
<li><strong>Entity Management</strong>: Repositories typically work with entities rather than DTOs, ensuring that the data layer remains focused on data persistence and operations.</li>
<li><strong>Custom Repository Classes</strong>: For complex queries or database interactions, extend the basic repository functionality provided by the ORM to create custom repository classes.</li>
</ul>
<h3 id="overall-design-considerations">Overall Design Considerations</h3>
<ul>
<li><strong>Modularity</strong>: Promote a modular approach where each module encapsulates a certain business domain, thus enhancing maintainability and scalability.</li>
<li><strong>Testing</strong>: Each layer can be independently tested. Controllers can be tested using end-to-end tests, services can be unit tested, and repositories can be tested using integration tests with the database.</li>
</ul>
<h3 id="code-samples">Code samples</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#75715e">// src/user/entities/user.entity.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Entity</span>, <span style="color:#a6e22e">Column</span>, <span style="color:#a6e22e">PrimaryGeneratedColumn</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;typeorm&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Entity</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@PrimaryGeneratedColumn</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Column</span>({ <span style="color:#66d9ef">unique</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> })
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">username</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Column</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">password</span>: <span style="color:#66d9ef">string</span>; <span style="color:#75715e">// In a real-world application, you would hash this value before storage
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Column</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">email</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Column</span>({ <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> })
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">isActive</span>: <span style="color:#66d9ef">boolean</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#75715e">// src/user/repositories/user.repository.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">EntityRepository</span>, <span style="color:#a6e22e">Repository</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;typeorm&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">User</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;../entities/user.entity&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@EntityRepository</span>(<span style="color:#a6e22e">User</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserRepository</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Repository</span>&lt;<span style="color:#f92672">User</span>&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Additional queries and methods specific to the user data can be placed here
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#75715e">// src/user/services/user.service.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Injectable</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/common&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">InjectRepository</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/typeorm&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserRepository</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;../repositories/user.repository&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">User</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;../entities/user.entity&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Injectable</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserService</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">@InjectRepository</span>(<span style="color:#a6e22e">UserRepository</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">userRepository</span>: <span style="color:#66d9ef">UserRepository</span>
</span></span><span style="display:flex;"><span>  ) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">findAll</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span><span style="color:#960050;background-color:#1e0010">[]</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">find</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">findOne</span>(<span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span> <span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#a6e22e">undefined</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">findOne</span>(<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">findByUsername</span>(<span style="color:#a6e22e">username</span>: <span style="color:#66d9ef">string</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span> <span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#a6e22e">undefined</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">findOne</span>({ <span style="color:#a6e22e">where</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">username</span> } });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">userData</span>: <span style="color:#66d9ef">User</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">save</span>(<span style="color:#a6e22e">userData</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>, <span style="color:#a6e22e">userData</span>: <span style="color:#66d9ef">Partial</span>&lt;<span style="color:#f92672">User</span>&gt;)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">userData</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#a6e22e">findOne</span>(<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">remove</span>(<span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">void</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userRepository</span>.<span style="color:#66d9ef">delete</span>(<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#75715e">// src/user/controllers/user.controller.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Controller</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Get</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Post</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Body</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Param</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Delete</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Put</span>,
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;@nestjs/common&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">UserService</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;../services/user.service&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">User</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;../entities/user.entity&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">@Controller</span>(<span style="color:#e6db74">&#34;users&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserController</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> <span style="color:#a6e22e">userService</span>: <span style="color:#66d9ef">UserService</span>) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Get</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">findAll</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span><span style="color:#960050;background-color:#1e0010">[]</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userService</span>.<span style="color:#a6e22e">findAll</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Get</span>(<span style="color:#e6db74">&#34;:id&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">findOne</span>(<span style="color:#66d9ef">@Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>) <span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userService</span>.<span style="color:#a6e22e">findOne</span>(<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Post</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">create</span>(<span style="color:#66d9ef">@Body</span>() <span style="color:#a6e22e">userData</span>: <span style="color:#66d9ef">User</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userService</span>.<span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">userData</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Put</span>(<span style="color:#e6db74">&#34;:id&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">update</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">@Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>) <span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">@Body</span>() <span style="color:#a6e22e">userData</span>: <span style="color:#66d9ef">Partial</span>&lt;<span style="color:#f92672">User</span>&gt;
</span></span><span style="display:flex;"><span>  )<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">User</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userService</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">userData</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">@Delete</span>(<span style="color:#e6db74">&#34;:id&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">remove</span>(<span style="color:#66d9ef">@Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>) <span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">void</span>&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">userService</span>.<span style="color:#a6e22e">remove</span>(<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="pros-2">Pros</h3>
<ol>
<li>
<p><strong>Separation of Concerns</strong></p>
<ul>
<li>Ensures each layer focuses on specific responsibilities, simplifying maintenance and extension of the application.</li>
</ul>
</li>
<li>
<p><strong>Scalability</strong></p>
<ul>
<li>Individual layers can scale based on specific needs, aiding efficient resource utilization.</li>
</ul>
</li>
<li>
<p><strong>Reusability</strong></p>
<ul>
<li>Business logic in the services layer can be reused across different parts of the application, enhancing code efficiency.</li>
</ul>
</li>
<li>
<p><strong>Testability</strong></p>
<ul>
<li>Independent testing of layers streamlines test case writing and debugging.</li>
</ul>
</li>
<li>
<p><strong>Modularity</strong></p>
<ul>
<li>Enhances application organization through modular encapsulation of components, aligned with NestJS&rsquo;s architecture.</li>
</ul>
</li>
<li>
<p><strong>Flexibility in Data Management</strong></p>
<ul>
<li>The repository layer&rsquo;s focus on data handling allows easy modifications to persistence logic without impacting other layers.</li>
</ul>
</li>
</ol>
<h3 id="cons-2">Cons</h3>
<ol>
<li>
<p><strong>Complexity in Setup</strong></p>
<ul>
<li>Initial setup can be complex and might be daunting for new developers.</li>
</ul>
</li>
<li>
<p><strong>Overhead</strong></p>
<ul>
<li>Additional code and abstraction layers can lead to unnecessary complexity in smaller projects.</li>
</ul>
</li>
<li>
<p><strong>Dependency Management</strong></p>
<ul>
<li>Managing dependencies across multiple layers can be challenging, especially in large projects.</li>
</ul>
</li>
<li>
<p><strong>Potential for Redundant Abstractions</strong></p>
<ul>
<li>Data may need to be mapped and transformed across layers multiple times, potentially reducing performance.</li>
</ul>
</li>
<li>
<p><strong>Learning Curve</strong></p>
<ul>
<li>NestJS’s advanced features such as Dependency Injection, Modules, and Decorators can have a steep learning curve.</li>
</ul>
</li>
<li>
<p><strong>Database-Driven Design Constraints</strong></p>
<ul>
<li>Tight coupling of entities to the database schema can sometimes limit the implementation flexibility for certain business logic.</li>
</ul>
</li>
</ol>
<p>This structured approach is ideal for medium to large-scale applications but may be excessive for smaller projects. It is crucial to assess the project&rsquo;s specific needs to determine the most suitable architecture.</p>
<h2 id="conclusion">Conclusion</h2>
<ul>
<li>Feel free to design your approach to adapt with your business requirements and your teams.</li>
</ul>
<p>Code fun ^^.</p>
        
      
      <div class="m-1 p-1">
        
          <a class="m-1 p-1 text-xs font-bold leading-none border border-gray-200 bg-white" href="http://localhost:1313/categories/nestjs">nestjs</a>
        
          <a class="m-1 p-1 text-xs font-bold leading-none border border-gray-200 bg-white" href="http://localhost:1313/categories/frameworks">frameworks</a>
        
      </div>
    </div>
  </section>
  <section class="container section">
    <div class="max-w-2xl mx-auto">
      <div class="font-heading text-2xl font-semibold">You Might Also Like</div>
      <div class="mt-8 grid  gap-8">
        
        
        
        
        <ul class="sidebar-links">
        
        
            <li><a href="/post/build-restful-api-with-nestjs-the-right-way/">Build Restful Api With Nestjs the Right Way</a></li>
        
            <li><a href="/post/the-best-way-to-upload-file-in-nestjs/">The Best Way to Upload File in Nestjs</a></li>
        
            <li><a href="/post/vuejs-how-to-add-tailwind-in-your-application/">Vuejs How to Add TailwindCSS in Your Application</a></li>
        
            <li><a href="/post/nestjs-request-and-response-object/">Nestjs Request and Response Object</a></li>
        
            <li><a href="/post/nestjs-pipes/">Nestjs Pipes</a></li>
        
            <li><a href="/post/validate-request-input-in-nestjs/">Validate Request Input in Nestjs</a></li>
        
            <li><a href="/post/nestjs-provider/">Nestjs Provider</a></li>
        
        </ul>
                
      </div>
    </div>
  </section>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1642510310947288"
  crossorigin="anonymous"></script>
  <ins class="adsbygoogle"
        style="display:block; text-align:center;"
        data-ad-layout="in-article"
        data-ad-format="fluid"
        data-ad-client="ca-pub-1642510310947288"
        data-ad-slot="9309117729"></ins>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
  </script>  

    
    </main>
    <footer class="footer">
      <div class="container md:flex">
        <section class="footer-section-info md:basis-1/4">
          <div class="address">
            <a class="logo" href="http://localhost:1313/" title="NextJSVietNam">
              NextJSVietNam
            </a>
            <h4 class="footer-heading">
                DEVELOPMENT MODE
            <h4>                
          </div>
        </section>
        <div class="footer-section-navigation-menu md:basis-1/4">
          <h4 class="footer-heading">NestJS</h4>
          <ul class="footer-section-navigation-menu-links">
            
            
              <li><a href="http://localhost:1313/post/nestjs-passing-data-between-layers-in-ddd/">Nestjs Passing Data Between Layers in Domain Driven Design</a></li>              
            
              <li><a href="http://localhost:1313/post/khoa-hoc-nestjs-bai-06-viet-unit-test/">Khóa học NestJS - Bài 06 Hướng dẫn viết Unit Test</a></li>              
            
              <li><a href="http://localhost:1313/post/khoa-hoc-nestjs-bai-05-repository-pattern/">Khóa học NestJS Bài 05 - Repository Pattern</a></li>              
            
              <li><a href="http://localhost:1313/post/khoa-hoc-nestjs-bai-04-model-and-repository-pattern/">Khóa học NestJS Bài 04 - Model and Repository Pattern</a></li>              
            
              <li><a href="http://localhost:1313/post/khoa-hoc-nestjs-bai03/">Khóa học NestJS Bài 03 - Controllers &amp; Views</a></li>              
             
          </ul>
        </div>
        <div class="footer-section-navigation-menu md:basis-1/4">
          <h4 class="footer-heading">NextJS</h4>
          <ul class="footer-section-navigation-menu-links">
            
            
              <li><a href="http://localhost:1313/post/khoa-hoc-nextjs-bai-03-advanced-routing/">Khoá học NextJS Bài 03 - Advanced Routing</a></li>              
            
              <li><a href="http://localhost:1313/post/khoa-hoc-nextjs-bai-02-cau-truc-du-an-nextjs/">Khoá học NextJS 2024 - Bài 02: Cấu trúc dự án NextJS</a></li>              
            
              <li><a href="http://localhost:1313/post/create-new-website-with-nextjs/">Create New Website With Nextjs</a></li>              
            
              <li><a href="http://localhost:1313/post/khoa-hoc-nextjs/">Khóa học NextJS - Bài 01 - Lộ trình các bài học về NextJS</a></li>              
             
          </ul>
        </div>
        <div class="footer-section-navigation-menu md:basis-1/4">
          <h4 class="footer-heading">Cheatsheet</h4>
          <ul class="footer-section-navigation-menu-links">
            
            
              <li><a href="http://localhost:1313/post/6minutes-tech-graphql/">6minutes Tech Graphql</a></li>              
            
              <li><a href="http://localhost:1313/post/6minutes-tech-progressive-web-app/">6minutes Tech Progressive Web App</a></li>              
            
              <li><a href="http://localhost:1313/post/flexbox-and-real-world-examples/">Flexbox and Real World Examples</a></li>              
            
              <li><a href="http://localhost:1313/post/react-native-examples-setup-working-place-for-react-native-developer/">[React Native Examples] Setup Working Place for React Native Developer</a></li>              
            
              <li><a href="http://localhost:1313/post/happy-new-year-2024/">Happy New Year 2024</a></li>              
             
          </ul>
        </div>
      </div>
      <div class="container">
        <div class="text-center">
          <a href=""><span class="material-icons text-4xl m-4">facebook</span></a>
          <a href=""><span class="material-icons text-4xl  m-4">smart_display</span></a>
        </div>
        <div class="text-center text-lg py-4">
          Copyright @ NextJSVietNam 2022
        </div>
        <div class="text-center text-sm">
          Powered by <a class="font-bold text-primary" href="https://gohugo.io/">Go Hugo</a> - Made
          with love from <a class="font-bold text-primary" href="http://localhost:1313/">NextJSVietNam</a> -
          Build
          Version 2024-04-27 14:31:26 &#43;0700 &#43;07
        </div>
      </div>
    </footer>

    
    
      
        
        
        
          <script type="text/javascript" src="http://localhost:1313/core/jquery-3.6.0.min.js"></script>
        
             
    
      
        
        
        
          <script type="text/javascript" src="http://localhost:1313/themes/2022/dist/main.js"></script>
        
             
    
      
        
        
        
          <script type="text/javascript" src="http://localhost:1313/themes/2022/dist/home.js"></script>
        
             
    

  
  <script async>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1760611910980690');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1760611910980690&ev=PageView&noscript=1"
    /></noscript>
        
  </body>
</html>
